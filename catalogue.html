<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Catalogue - Site Commande</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <h1>Catalogue</h1>
    <form id="catalogueForm">
      <div id="articlesList"></div>
      <button type="submit">Voir le récapitulatif</button>
    </form>
  </div>

  <script>
    if (!sessionStorage.getItem("user")) {
      alert("Veuillez vous connecter d'abord.");
      window.location.href = "index.html";
    }

    // Liste des articles (tu peux modifier ici)
    const articles = [
      {
        id: 1,
        name: "Caoutchouc",
        price: 6,
        img: "https://media.istockphoto.com/id/1442417585/fr/photo/personne-recevant-un-morceau-de-pizza-au-pepperoni-au-fromage.jpg?s=612x612&w=0&k=20&c=xNz2rodZQQARx16BlXTkht9E19aw4ziOMm6UOjW5DKM=",
      },
      {
        id: 2,
        name: "Encre",
        price: 6,
        img: "images/salade-cesar.jpg",
      },
      {
        id: 3,
        name: "Eponge pour voiture",
        price: 2,
        img: "images/pates-bolognaise.jpg",
      },
      {
        id: 4,
        name: "Bidon peinture",
        price: 2,
        img: "images/salade-cesar.jpg",
      },
      {
        id: 5,
        name: "Solvant",
        price: 22,
        img: "images/salade-cesar.jpg",
      },
      {
        id: 6,
        name: "Pâtes",
        price: 2,
        img: "images/salade-cesar.jpg",
      },
      {
        id: 7,
        name: "Nouilles",
        price: 2,
        img: "images/salade-cesar.jpg",
      },
      {
        id: 8,
        name: "Coca Zero",
        price: 2,
        img: "images/salade-cesar.jpg",
      },
      {
        id: 9,
        name: "Caramel",
        price: 2,
        img: "images/salade-cesar.jpg",
      },
      {
        id: 10,
        name: "Tortilla",
        price: 2,
        img: "images/salade-cesar.jpg",
      },
      {
        id: 11,
        name: "Crème glacée",
        price: 2,
        img: "images/salade-cesar.jpg",
      },
      {
        id: 12,
        name: "Crème glacée (pot)",
        price: 2,
        img: "images/salade-cesar.jpg",
      },
      {
        id: 13,
        name: "Crème fraiche",
        price: 2,
        img: "images/salade-cesar.jpg",
      },
      {
        id: 14,
        name: "Moutarde",
        price: 2,
        img: "images/salade-cesar.jpg",
      },
      {
        id: 15,
        name: "Coquille à tacos",
        price: 2,
        img: "images/salade-cesar.jpg",
      },
      {
        id: 16,
        name: "Pain à burger",
        price: 2,
        img: "images/salade-cesar.jpg",
      },
      {
        id: 17,
        name: "Barre de chocolat",
        price: 2,
        img: "images/salade-cesar.jpg",
      },
      {
        id: 18,
        name: "Pain grillé",
        price: 2,
        img: "images/salade-cesar.jpg",
      },
      {
        id: 19,
        name: "Bagel",
        price: 2,
        img: "images/salade-cesar.jpg",
      },
      {
        id: 20,
        name: "Eau purifié",
        price: 1,75,
        img: "images/salade-cesar.jpg",
      },
    ];

    const articlesList = document.getElementById("articlesList");

    // Affiche les articles dans le formulaire
    articles.forEach((art) => {
      const articleDiv = document.createElement("div");
      articleDiv.className = "article";

      articleDiv.innerHTML = `
        <img src="${art.img}" alt="${art.name}" />
        <div class="article-details">
          <strong>${art.name}</strong><br />
          Prix : ${art.price} €
        </div>
        <div class="article-qty">
          <label>Quantité :</label>
          <input type="number" min="0" value="0" name="qty-${art.id}" />
        </div>
      `;

      articlesList.appendChild(articleDiv);
    });

    // Envoi du formulaire
    const form = document.getElementById("catalogueForm");
    form.addEventListener("submit", (e) => {
      e.preventDefault();

      const formData = new FormData(form);
      const order = [];

      articles.forEach((art) => {
        const qty = parseInt(formData.get(`qty-${art.id}`)) || 0;
        if (qty > 0) {
          order.push({ ...art, quantity: qty });
        }
      });

      if (order.length === 0) {
        alert("Veuillez sélectionner au moins un article.");
        return;
      }

      sessionStorage.setItem("order", JSON.stringify(order));
      window.location.href = "recap.html";
    });
  </script>
</body>
</html>
