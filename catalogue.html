<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Catalogue - Site Commande</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 900px;
      margin: 20px auto;
      padding: 0 15px;
    }
    .container h1 {
      text-align: center;
      margin-bottom: 30px;
    }
    .article {
      display: flex;
      align-items: center;
      border: 1px solid #ddd;
      padding: 10px;
      margin-bottom: 15px;
      border-radius: 5px;
    }
    .article img {
      max-width: 100px;
      max-height: 100px;
      object-fit: contain;
      margin-right: 20px;
    }
    .article-details {
      flex-grow: 1;
      font-size: 1.1em;
    }
    .article-qty {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    }
    .article-qty label {
      font-weight: bold;
      margin-bottom: 5px;
    }
    .article-qty input[type="number"] {
      width: 60px;
      padding: 5px;
    }
    button[type="submit"] {
      display: block;
      margin: 30px auto 0;
      padding: 12px 25px;
      font-size: 1.1em;
      cursor: pointer;
      background-color: #007bff;
      border: none;
      color: white;
      border-radius: 5px;
    }
    button[type="submit"]:hover {
      background-color: #0056b3;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Catalogue</h1>
    <form id="catalogueForm">
      <div id="articlesList"></div>
      <button type="submit">Voir le récapitulatif</button>
    </form>
  </div>

  <script>
    // Vérifie que l'utilisateur est connecté
    if (!sessionStorage.getItem("user")) {
      alert("Veuillez vous connecter d'abord.");
      window.location.href = "index.html";
    }

    // Liste des articles
    const articles = [
      { id: 1, name: "Caoutchouc", price: 6, img: "https://cdn.discordapp.com/attachments/1009082381862445128/1396352604468019250/image_2025-07-20_064658351-removebg-preview.png" },
      { id: 2, name: "Encre", price: 6, img: "https://cdn.discordapp.com/attachments/1009082381862445128/1396352977094316093/image_2025-07-20_064825842-removebg-preview.png" },
      { id: 3, name: "Eponge pour voiture", price: 2, img: "https://cdn.discordapp.com/attachments/1009082381862445128/1396353141775274064/image_2025-07-20_064900049-removebg-preview.png" },
      { id: 4, name: "Bidon peinture", price: 2, img: "https://cdn.discordapp.com/attachments/1009082381862445128/1396353487041724457/image_2025-07-20_065010388-removebg-preview.png" },
      { id: 5, name: "Solvant", price: 22, img: "https://cdn.discordapp.com/attachments/1009082381862445128/1396353871625846905/image_2025-07-20_065125429-removebg-preview.png" },
      { id: 6, name: "Pâtes", price: 2, img: "https://cdn.discordapp.com/attachments/1009082381862445128/1396354182772035594/image_2025-07-20_065314844-removebg-preview.png" },
      { id: 7, name: "Nouilles", price: 2, img: "https://cdn.discordapp.com/attachments/1009082381862445128/1396354304134221876/image_2025-07-20_065344347-removebg-preview.png" },
      { id: 8, name: "Coca Zero", price: 2, img: "https://cdn.discordapp.com/attachments/1009082381862445128/1396354487467114547/image_2025-07-20_065426263-removebg-preview.png" },
      { id: 9, name: "Caramel", price: 2, img: "https://cdn.discordapp.com/attachments/1009082381862445128/1396354627548610592/image_2025-07-20_065459038-removebg-preview.png" },
      { id: 10, name: "Tortilla", price: 2, img: "https://cdn.discordapp.com/attachments/1009082381862445128/1396355000023781406/image_2025-07-20_065629361-removebg-preview.png" },
      { id: 11, name: "Crème glacée", price: 2, img: "https://cdn.discordapp.com/attachments/1009082381862445128/1396355486143484069/image_2025-07-20_065826545-removebg-preview.png" },
      { id: 12, name: "Crème glacée (pot)", price: 2, img: "https://cdn.discordapp.com/attachments/1009082381862445128/1396355632596123688/image_2025-07-20_065853685-removebg-preview.png" },
      { id: 13, name: "Crème fraiche", price: 2, img: "https://cdn.discordapp.com/attachments/1009082381862445128/1396355755392634920/image_2025-07-20_065927736-removebg-preview.png" },
      { id: 14, name: "Moutarde", price: 2, img: "https://cdn.discordapp.com/attachments/1009082381862445128/1396355858866114570/image_2025-07-20_065955050-removebg-preview.png" },
      { id: 15, name: "Coquille à tacos", price: 2, img: "https://cdn.discordapp.com/attachments/1009082381862445128/1396355951749107772/image_2025-07-20_070018869-removebg-preview.png" },
      { id: 16, name: "Pain à burger", price: 2, img: "https://cdn.discordapp.com/attachments/1009082381862445128/1396356192988823602/image_2025-07-20_070111651-removebg-preview.png" },
      { id: 17, name: "Barre de chocolat", price: 2, img: "https://cdn.discordapp.com/attachments/1009082381862445128/1396356044921245860/image_2025-07-20_070039378-removebg-preview.png" },
      { id: 18, name: "Pain grillé", price: 2, img: "https://cdn.discordapp.com/attachments/1009082381862445128/1396356338019467366/image_2025-07-20_070137097-removebg-preview.png" },
      { id: 19, name: "Bagel", price: 2, img: "https://cdn.discordapp.com/attachments/1009082381862445128/1396356440406360084/image_2025-07-20_070213952-removebg-preview.png" },
      { id: 20, name: "Eau purifiée", price: 1.75, img: "https://cdn.discordapp.com/attachments/1009082381862445128/1396356559809806396/image_2025-07-20_070241777-removebg-preview.png" },
    ];

    const articlesList = document.getElementById("articlesList");

    // Affiche les articles dans le formulaire
    articles.forEach((art) => {
      const articleDiv = document.createElement("div");
      articleDiv.className = "article";

      articleDiv.innerHTML = `
        <img src="${art.img}" alt="${art.name}" />
        <div class="article-details">
          <strong>${art.name}</strong><br />
          Prix : ${art.price.toFixed(2)} €
        </div>
        <div class="article-qty">
          <label for="qty-${art.id}">Quantité :</label>
          <input type="number" min="0" value="0" id="qty-${art.id}" name="qty-${art.id}" />
        </div>
      `;

      articlesList.appendChild(articleDiv);
    });

    // Envoi du formulaire
    const form = document.getElementById("catalogueForm");
    form.addEventListener("submit", (e) => {
      e.preventDefault();

      const formData = new FormData(form);
      const order = [];

      articles.forEach((art) => {
        const qty = parseInt(formData.get(`qty-${art.id}`), 10) || 0;
        if (qty > 0) {
          order.push({ ...art, quantity: qty });
        }
      });

      if (order.length === 0) {
        alert("Veuillez sélectionner au moins un article.");
        return;
      }

      sessionStorage.setItem("order", JSON.stringify(order));
      window.location.href = "recap.html";
    });
  </script>
</body>
</html>
